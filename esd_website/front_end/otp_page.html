<!doctype html>
<html class="no-js" lang="">

<head>
    <meta charset="utf-8">
    <title>OAK - HTML Theme</title>
    <meta name="description" content="">
    <meta name="msapplication-tap-highlight" content="yes" />
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1, minimum-scale=1.0, maximum-scale=1.0" />

    <!-- Google Web Font -->
    <link href='http://fonts.googleapis.com/css?family=Ubuntu:300,400,500,700' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Lekton:400,700,400italic' rel='stylesheet' type='text/css'>

    <!--  Bootstrap 3-->
    <link rel="stylesheet" href="css/bootstrap.min.css">

    <!-- OWL Carousel -->
    <link rel="stylesheet" href="css/owl.carousel.css">
    <link rel="stylesheet" href="css/owl.theme.css">

    <!--  Slider -->
    <link rel="stylesheet" href="css/jquery.kenburnsy.css">

    <!-- Animate -->
    <link rel="stylesheet" href="css/animate.css">

    <!-- Web Icons Font -->
    <link rel="stylesheet" href="css/pe-icon-7-stroke.css">
    <link rel="stylesheet" href="css/iconmoon.css">
    <link rel="stylesheet" href="css/et-line.css">
    <link rel="stylesheet" href="css/ionicons.css">

    <!-- Magnific PopUp -->
    <link rel="stylesheet" href="css/magnific-popup.css">

    <!-- Tabs -->
    <link rel="stylesheet" type="text/css" href="css/tabs.css" />
    <link rel="stylesheet" type="text/css" href="css/tabstyles.css" />

    <!-- Loader Style -->
    <link rel="stylesheet" href="css/loader-1.css">

    <!-- Costum Styles -->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/responsive.css">

    <!-- Favicon -->
    <link rel="icon" type="image/ico" href="favicon.ico">

    <!-- Modernizer & Respond js -->
    <script src="js/vendor/modernizr-2.8.3-respond-1.4.2.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.min.js"></script>
</head>

<body>

    <!-- Preloader -->
    <div class="cover"></div>

    <div class="header">
        <div class="container">
            <div class="logo">
                <a href="index.html">
                    <img src="img/logo.png" alt="Logo">
                </a>
            </div>
            
            <!-- Menu Hamburger (Default) -->
            <button class="main-menu-indicator" id="open-button">
                <span class="line"></span>
            </button>
            
            <div class="menu-wrap" style="background-image: url(img/nav_bg.jpg)">
                <div class="menu-content">
                    <div class="navigation">
                        <span class="pe-7s-close close-menu" id="close-button"></span>
                        <div class="search-wrap js-ui-search">
                            <input class="js-ui-text" type="text" placeholder="Search Here...">
                            <span class="eks js-ui-close"></span>
                        </div>
                    </div>
                    <nav class="menu">
                        <div class="menu-list">
                            <ul>
                                <!-- <li class="menu-item-has-children"><a href="index.html">Home</a></li> -->
                                <li class="menu-item-has-children"><a href="index.html">Home</a></li>
                                <li><a href="contact.html">Contact</a></li>
                            </ul>
                        </div>
                    </nav>

                    <div class="hidden-xs">
                        <div class="menu-social-media">
                            <ul>
                               <li><a href="#"><i class="iconmoon-facebook"></i></a></li>
                               <li><a href="#"><i class="iconmoon-twitter"></i></a></li>
                               <li><a href="#"><i class="iconmoon-dribbble3"></i></a></li>
                               <li><a href="#"><i class="iconmoon-pinterest"></i></a></li>
                               <li><a href="#"><i class="iconmoon-linkedin2"></i></a></li>
                            </ul>
                        </div>

                        <div class="menu-information">
                            <ul>
                                <li><span>T:</span> 65 91117444</li>
                                <li><span>E:</span> raffle_services@gmail.com</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <!-- End of Menu Hamburger (Default) -->

        </div>
    </div>

    <div class="container margin-top">
        
        <div class="col-md-4">
            <div class="row">
                <div class="services-home-page">
                    <div class="main-title">
                        <h1>WHY CHOOSE US?</h1>
                    </div>

                    <div class="col-md-12 wow fadeInUp" data-wow-duration="0.2s" data-wow-delay="0.2s">
                        <div class="row">
                            <div class="services-icon">
                                <span class="icon-tools"></span>
                                <hr>
                            </div>
                            <h4>RELIABILITY</h4>
                            <p>Our services will not compromise your details and you can feel safe with your personal information being protected.</p>
                        </div>
                    </div>
                    <div class="col-md-12 wow fadeInUp" data-wow-duration="0.4s" data-wow-delay="0.4s">
                        <div class="row">
                            <div class="services-icon">
                                <span class="icon-globe"></span>
                                <hr>
                            </div>
                            <h4>PROFESSIONALISM</h4>
                            <p>Our system is unbiased and gives everybody an equal chance of getting what they want! There is nowhere else that can give you a chance like we do</p>
                        </div>
                    </div>
                    <!-- <div class="col-md-12 wow fadeInUp" data-wow-duration="0.6s" data-wow-delay="0.6s">
                        <div class="row">
                            <div class="services-icon">
                                <span class="icon-paintbrush"></span>
                                <hr>
                            </div>
                            <h4>ILUSTRATION</h4>
                            <p>Pound the actual teachings of the great explorer of the truth, the master-builder of human happiness. No one rejects, dislikes, or avoids pleasure itself, because.</p>
                        </div>
                    </div> -->
                </div>
            </div>
        </div>
        <div class="col-md-7 col-md-offset-1">
            <div class="our-story-image wow fadeInUp" data-wow-duration="1s" data-wow-delay="1s">
                <div class="main-title">
                    <h1>Enter your Phone Number to get an OTP</h1>
                </div>
                <form method="POST" id="get_otp_form" action="otp_page.html">
                    <div class="contact-form">
                        <h4>Phone Number </h4>
                        <input type="text" id="phoneNumber" placeholder="PHONE NUMBER *">
                        <input type="submit" style="color: black" value="Get OTP">
                    </div>
                </form>
                <br><br><br>
            </div>

            
            <div class="our-story-image wow fadeInUp" data-wow-duration="1s" data-wow-delay="1.5s" id="enter_otp">
                <div class="main-title" id="enter_otp_title">
                    <h1>Enter your OTP</h1>
                </div>
                <form method="POST" id="submit_otp_form" action="entry.html">
                    <div class="contact-form">
                        <h4>Code </h4>
                        <input type="text" id="otp_code" placeholder="OTP CODE *">
                        <input type="submit" style="color: black" value="CONFIRM">
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div class="footer margin-top">
        <div class="container">
            <div class="row">
                <div class="col-md-2 col-sm-4 col-xs-12">
                    <div class="footer-inner">
                        <div class="footer-content">
                            <h4>RAFFLE SYSTEMS</h4>
                                <address>81 Victoria St<br>Singapore 188065</address>
                        </div>
                    </div>
                </div>

                <div class="col-md-2 col-md-push-8 col-sm-4 col-xs-12">
                    <div class="footer-inner">
                        <div class="footer-content">
                           <h4>CONTACT INFO</h4>
                            <p>
                                T:65 91117444 <br>
                                E:raffle_services@gmail.com <br>
                                W:www.rafflesystems.com
                            </p>
                        </div>
                    </div>
                </div>

                    <div class="col-md-4 col-sm-4 col-xs-12">
                        <div class="footer-inner">
                            <div class="footer-content">
                            <ul class="social-media">
                                <li><a href="#"><i class="iconmoon-facebook"></i></a></li>
                                <li><a href="#"><i class="iconmoon-twitter"></i></a></li>
                                <li><a href="#"><i class="iconmoon-flickr2"></i></a></li>
                                <li><a href="#"><i class="iconmoon-dribbble3"></i></a></li>
                                <li><a href="#"><i class="iconmoon-pinterest"></i></a></li>
                                <li><a href="#"><i class="iconmoon-linkedin2"></i></a></li>
                            </ul>
                            <span class="copyright-mark">&copy; 2021 RAFFLE SYSTEMS, ALL RIGHTS RESERVED</span>
                            </div>
                        </div>
                    </div>
            </div>
        </div>
    </div>
    <a href="javascript:void(0)" class="scroll-top" id="scroll-top"><i class="pe-7s-angle-up"></i></a>

    <script src="js/vendor/jquery-1.11.2.min.js"></script>
    <script data-pace-options='{ "ajax": false }' src="js/vendor/pace.min.js"></script>
    <script src="js/vendor/bootstrap.min.js"></script>
    <script src="js/vendor/classie.js"></script>
    <script src="js/vendor/isotope.pkgd.min.js"></script>
    <script src="js/vendor/jquery.velocity.min.js"></script>
    <script src="js/vendor/jquery.kenburnsy.min.js"></script>
    <script src="js/vendor/textslide.js"></script>
    <script src="js/vendor/imagesloaded.pkgd.min.js"></script>
    <script src="js/vendor/tabs.js"></script>
    <script src="js/ef-slider.js"></script>    
    <script src="js/vendor/owl.carousel.min.js"></script>
    <script src="js/vendor/jquery.magnific-popup.min.js"></script>
    <script src="js/vendor/jquery.social-buttons.min.js"></script>
    <script src="js/vendor/wow.min.js"></script>
    <script src="js/main.js"></script>
    <script src="js/ajax.js"></script>
    <script>
        // preventing default form action
        // var otp_id = "";
        var phone_num = "";
        cid = window.sessionStorage.getItem("company_id");
        pid = window.sessionStorage.getItem("product_id");

        document.getElementById("get_otp_form").addEventListener("submit", e =>{
            e.preventDefault();
            console.log("form has been submitted")
            get_otp_fuct()
        });

        document.getElementById("submit_otp_form").addEventListener("submit", e =>{
            e.preventDefault();
            console.log("form has been submitted")
            submit_code()
        });

        
        async function get_otp_fuct(){
            phone_num_str = "65".concat(document.getElementById("phoneNumber").value);
            phone_num = parseInt(phone_num_str);
            window.sessionStorage.setItem("phone_num", phone_num)
            get_otp_url = "http://raffleoak.tech:5010/get_otp";

            requestBody = {
                phone_number: phone_num
            }

            var requestParam = {
                headers:{"content-type": "application/json; charset=UTF-8"},
                mode: "cors",
                method: "POST",
                body: JSON.stringify(requestBody)
            }
            try {
                const response = await fetch(get_otp_url, requestParam);
                data = await response.json();
                console.log(data);
                // otp_id = data.otp_id;
            } catch (error){
                console.error(error);
            }            
        }

        async function submit_code(){
            var otp_code = document.getElementById("otp_code").value;
            console.log(otp_code)
            // console.log(otp_id)
            verify_otp_url = "http://raffleoak.tech:5010/verify_otp";
            phone_num = window.sessionStorage.getItem("phone_num")
            requestBody = {
                phone_number: phone_num,
                otp_code: otp_code
            }

            var requestParam = {
                headers:{"content-type": "application/json; charset=UTF-8"},
                mode: "cors",
                method: "POST",
                body: JSON.stringify(requestBody)
            }
            try {
                const response = await fetch(verify_otp_url, requestParam);
                data = await response.json();
                console.log(data)
                status = data.message
                if(status === "success"){
                    window.sessionStorage.setItem("phone_num", phone_num)
                    verify()
                }

            } catch (error){
                console.error(error);
            }            
        } 

        async function verify(){
            verify_otp_url = "http://raffleoak.tech:8000/api/v1/verification";
            // verify_otp_url = "http://raffleoak.tech:5100/verification";
            phone_num = window.sessionStorage.getItem("phone_num")

            cid = String(cid);
            pid = String(pid);

            requestBody = {
                phone_number: phone_num,
                company_id: cid,
                product_id: pid
            }

            console.log(requestBody) 


            var requestParam = {
                headers:{"content-type": "application/json; charset=UTF-8"},
                mode: "cors",
                method: "POST",
                body: JSON.stringify(requestBody)
            }
            try {
                const response = await fetch(verify_otp_url, requestParam);
                data = await response.json();
                console.log(data)
                redirect_status = data.status
                window.sessionStorage.setItem("redirect_status", redirect_status)
                if(redirect_status == "failed"){
                    // document.getElementById("submit_otp_form").setAttribute("action", "confirmation.html");
                    window.location.href = "confirmation.html"
                } else {
                    window.location.href = "entry.html"
                }
            } catch (error){
                console.error(error);
            }            
        } 
    </script>
</body>
</html>